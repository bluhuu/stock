<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<link rel="stylesheet" href="app.css">
	<link rel="stylesheet" href="jquery-ui.css">
</head>
<body>
	<div id="setting">
			<div class="title">选择浏览器显示图标</div>
			<div class="iconlist"></div>
			<span class="close">X</span>
			<a href="#" class="default">使用默认图标</a>
	</div>
	<ul class="nav-tabs">
		<li class="tab on" data-type="default"><a href="#">我的自选</a></li>
		<li class="tab"><a href="http://lhb.stock360.cn" target="_blank">龙虎榜</a></li>
		<li class="tab"><a href="http://lhb.stock360.cn/dz" target="_blank">破定增价股</a></li>
		<!-- <li class="tab"><a href="#" class="setting">个人设置</a></li> -->
	</ul>
	<div class="tab-content">
		<div class="tab-pane on">
			<form id="search" action="http://www.so.com/s" method="get" target="_self">
				<div class="search">
					<div class="search-input">
						<input type="text" id="input" name="q" placeholder="代码/名称/拼音">
					</div>
					<div class="search-button">
						<input type="submit" value="搜索">
					</div>
				</div>
			</form>
			<div id="zxg">
				<div class="loading"><img src="images/loading.gif" alt=""></div>
				<div class="zxg-stock">
					<div class="zxg-hd gclearfix">
						<span class="top">置顶</span>
						<span class="name">名称(代码)</span>
						<span class="price">最新价</span>
						<span class="grow">涨跌幅</span>
						<span class="hands">换手率</span>
						<span class="Pricetobookratio">市净率</span>
						<span class="pe_ttm">市盈率-静</span>
						<span class="pe_lyr">市盈率-动</span>
						<span class="remark">备注</span>
						<span class="delete">删除</span>
					</div>
					<div class="zxg-bd">
						<ul class="zxg-list">
						</ul>
					</div>
					<div class="tipStock"><span class="ok"></span>列表保存已成功</div>
				</div>
			</div>
		</div>
		<div class="tab-pane">
			<ul class="stockList">
				<li class="item head">
					<span class="title">股票名称(代码)</span>
					<span class="rating">推荐星级</span>
					<span class="type">类型</span>
					<span class="topic">概念</span>
				</li>
			</ul>
		</div>
		<div class="tab-pane">
			<ul class="weixin" id="weixin">

			</ul>
		</div>
	</div>

	<div class="remark-form">
		<div class="remark-hd">
			<span class="name"></span>(<span class="code"></span>) 当前股价:<span class="price"></span>
			<span class="close">X</span>
		</div>
		<div class="remark-bd">
			<textarea id="remark" placeholder="请输入您的购入理由和目标价位..."></textarea>
			<input type="hidden" id="remark-key" value="">
			<input type="button" class="btn" value="提交">
		</div>
	</div>
	<div class="mask"></div>
	<div id="warning" ></div>
	<div id="canvasDiv" class="extra1" role="echart" style="width:500px;height:400px;"></div>
</body>
	<script src ="jquery_1102.js"></script>
	<script src ="jquery-ui.js"></script>
	<script src ="libs\jquery.zclip.js"></script>
	<script src ="util.js"></script>
	<script src ="suggest.js"></script>
	<script src ="stock.js"></script>
	<script src ="app.js"></script>
	<script src ="asset/lib/echarts.js"></script>
	<script src ="asset/lib/moment.js"></script>

	<script type ="text/javascript">
		// --- tools ---------------------------------------------------------
		function unique(arr) {
			var result=[];
			for(var i=0; i<arr.length; i++){
				if(result.indexOf(arr[i])==-1){
					result.push(arr[i])
				}
			}
			return result;
		}
		// ------------------------------------------------------------
		var worldMapContainer = document.getElementById('canvasDiv');
		var myChart = echarts.init(worldMapContainer);

		var dataname = [
			{ value: '调拨入库',textStyle: {fontSize: 22,fontWeight:'normal',color: 'black'}},
			{ value: '调拨出库',textStyle: {fontSize: 22,fontWeight:'normal',color: 'black'}},
			{ value: '销售出库',textStyle: {fontSize: 22,fontWeight:'normal',color: 'black'}},
			{ value: '销售配送',textStyle: {fontSize: 22,fontWeight:'normal',color: 'black'}},
			{ value: '销售退货',textStyle: {fontSize: 22,fontWeight:'normal',color: 'black'}}
		];
		//--- 统计数据抽取 --------------------------------------------------------------------------------------------------------------
		function fetchData(url,symbol,size,callback){
			$.ajax({
					url: url,
					dataType: "jsonp",
					data: {
						symbol:symbol,
						size:size,
						page:1,
						_:new Date()
					},
					success: function(json, textStatus){
						if(textStatus == "success"){
							callback(json);
						}
					},
					error: function(XMLHttpRequest, textStatus, errorThrown) {
						console.log("查询失败: ",XMLHttpRequest);
					}
				});
		}

		function extrFinmainindex(json){
			var reportdatelist = json.list.map(function(value,index,arr){
				return {
					xAxisdata:moment(value.reportdate,"YYYYMMDD").format("YYYY"),
					seriesname:moment(value.reportdate,"YYYYMMDD").format("MM")
				};
			});
			console.log("xAxisdata: ",unique(reportdatelist.map(function(value){return value.xAxisdata}))
										.sort(function(a,b){return b-a;})
			);
			console.log("seriesname: ",unique(reportdatelist.map(function(value){return value.seriesname}))
										.sort(function(a,b){return b-a;})
										.map(function(value){return value+"月"})
			);
			console.log("jsonObjectKeysList: ",Object.keys(json.list[0]));

			var item = Object.keys(json.list[0])[3];
 			console.log( item, json.list.map(function(value,index,arr){ return value[item]; }) );

		}
		fetchData("https://xueqiu.com/stock/f10/finmainindex.json","SH600366",20,extrFinmainindex);
		function getchartdata1() {
			var collectrows = fetchColRows().collectrows[0];
		    return [{
		        value: collectrows.transfeIn,
		        itemStyle: {
		            normal: {
		                color: "#1cb4bf",
		            }
		        }
		    }, {
		        value: collectrows.transfeOut,
		        itemStyle: {
		            normal: {
		                color: "#1cb4bf",
		            }
		        }
		    }, {
		        value: collectrows.salesOut,
		        itemStyle: {
		            normal: {
		                color: "#1cb4bf",
		            }
		        }
		    }, {
		        value: collectrows.salesTrans,
		        itemStyle: {
		            normal: {
		                color: "#1cb4bf",
		            }
		        }
		    }, {
		        value: collectrows.salesReturn,
		        itemStyle: {
		            normal: {
		                color: "#1cb4bf",
		            }
		        }
		    }];
		}

		// var ColRowsData = getchartdata1();
		option = {
		    tooltip : {
		        trigger: 'axis',
		        axisPointer : {            // 坐标轴指示器，坐标轴触发有效
		            type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
		        }
		    },
		    legend: {
		        data:['三月','六月','九月','十二月']
		    },
		    grid: {
		        left: '3%',
		        right: '4%',
		        bottom: '3%',
		        containLabel: true
		    },
		    xAxis : [
		        {
		            type : 'category',
		            data : ['周一','周二','周三','周四','周五','周六','周日']//年
		        }
		    ],
		    yAxis : [
		        {
		            type : 'value'
		        }
		    ],
		    series : [
		        {
		            name:'视频广告',
		            type:'bar',
		            stack: '广告',
		            data:[150, 232, 201, 154, 190, 330, 410]
		        },
		        {
		            name:'搜索引擎',
		            type:'bar',
		            data:[862, 1018, 964, 1026, 1679, 1600, 1570],
		            markLine : {
		                lineStyle: {
		                    normal: {
		                        type: 'dashed'
		                    }
		                },
		                data : [
		                    [{type : 'min'}, {type : 'max'}]
		                ]
		            }
		        },
		        {
		            name:'百度',
		            type:'bar',
		            barWidth : 5,
		            stack: '搜索引擎',
		            data:[620, 732, 701, 734, 1090, 1130, 1120]
		        },
		        {
		            name:'谷歌',
		            type:'bar',
		            stack: '搜索引擎',
		            data:[120, 132, 101, 134, 290, 230, 220]
		        }
		    ]
		};
		myChart.setOption(option);
	</script>
</html>
